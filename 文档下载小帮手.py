import tkinter as tk
import sys
import threading
from queue import Queue
from io import BytesIO
import base64
from PIL import Image,ImageTk
from tkinter import messagebox
from datetime import datetime
import yuanchuangli
import wenku
import doc88
import docin
import renrendoc
import goldenhoe

submitEvent = threading.Event()  # Áî®‰∫éÂêåÊ≠•ÁöÑ‰∫ã‰ª∂ÂØπË±°
iscreatePopup=threading.Event()   #Áî®‰∫éÊéßÂà∂ÂºπÂá∫È™åËØÅÁ†ÅÁ™óÂè£
okEvent=threading.Event()            #Áî®‰∫éÊéßÂà∂ÂëäËØâÂ≠êËøõÁ®ãÂºπÁ™óÁªìÊùü
inputQueue=Queue()                     #Áî®‰∫éÂëäËØâÂ≠êËøõÁ®ã Áî®Êà∑ËæìÂÖ•ÁöÑÈ™åËØÅÁ†ÅÁªìÊûú
btnActive = False  # ÊéßÂà∂ÊåâÈíÆÊòØÂê¶ÁîüÊïàÁöÑÊ†áÂøó

def createPopup(event):
    def submitBtn(entry, event):
        user_input = entry.get()
        inputQueue.put(user_input)
        input_window.destroy()  # ÂÖ≥Èó≠ÂºπÁ™ó
        event.set()
    input_window = tk.Toplevel()
    input_window.title("È™åËØÅÁ†Å")
    label = tk.Label(input_window, text="ËØ∑ËæìÂÖ•È™åËØÅÁ†ÅÔºö")
    label.pack(padx=20, pady=10)

    entry = tk.Entry(input_window)
    entry.pack(padx=20, pady=5)

    submit_button = tk.Button(input_window, text="Êèê‰∫§",
                              command=lambda :submitBtn(entry, event))
    submit_button.pack(pady=10)

    input_window.grab_set()
def checkEvent():
    if iscreatePopup.is_set():
        iscreatePopup.clear()
        createPopup(okEvent)
    root.after(100,checkEvent)
def onYesSelect():
    global withhead
    withhead=True
    print('Á®ãÂ∫èÊ®°ÂºèË∞ÉÊï¥‰∏∫ÊòæÂºèÁà¨Âèñ')

def onNoSelect():
    global withhead
    withhead=False
    print('Á®ãÂ∫èÊ®°ÂºèË∞ÉÊï¥‰∏∫ÈöêÂºèÁà¨Âèñ')

def onSubmit():
    """
    Êèê‰∫§ÊåâÈíÆÁöÑÂõûË∞ÉÂáΩÊï∞ÔºåË¥üË¥£Ê†°È™åËæìÂÖ•Âπ∂Ëß¶Âèë‰∫ã‰ª∂„ÄÇ
    """
    if not btnActive:
        return
    userID = userIDInput.get().strip()
    password = passwdInput.get().strip()

    if not userID or not password:
        messagebox.showerror("ÈîôËØØ", "Áî®Êà∑ÂêçÂíåÂØÜÁ†Å‰∏çËÉΩ‰∏∫Á©∫ÔºÅ")
        return
    global  submitEvent
    submitEvent.set()  # Ëß¶Âèë‰∫ã‰ª∂ÔºåËß£Èô§Êüê‰∏Ä‰∏™Á∫øÁ®ãÈòªÂ°û
class RedirectOutput:
    """
    Ëá™ÂÆö‰πâÁ±ªÔºåÁî®‰∫éÂ∞ÜÊéßÂà∂Âè∞ËæìÂá∫ÈáçÂÆöÂêëÂà∞ Tkinter ÁöÑ Text Êéß‰ª∂„ÄÇ
    """
    def __init__(self, textWidget):
        self.textWidget = textWidget

    def write(self, message):
        # Âú® Text Êéß‰ª∂Êú´Â∞æÊèíÂÖ•Ê∂àÊÅØ
        self.textWidget.insert(tk.END, message)
        self.textWidget.see(tk.END)  # Ëá™Âä®ÊªöÂä®Âà∞ÊúÄÊñ∞ÂÜÖÂÆπ

    def flush(self):
        # ‰∏∫‰∫ÜÂÖºÂÆπÊñá‰ª∂ÊèèËø∞Á¨¶ÁöÑ flush ÊñπÊ≥ïÔºåÂèØ‰ª•‰∏çÂÆûÁé∞ÂÖ∑‰ΩìÈÄªËæë
        pass

def checkPasswd(website):
    print(f'ÊÇ®ËæìÂÖ•ÁöÑÊñáÊ°£Â≠òÊîæ‰∫é{website}ÔºåÈúÄË¶ÅÊÇ®Êèê‰æõ{website}ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÊâçÊúâÂèØËÉΩ‰∏ãËΩΩÂÆåÂÖ®')
    userID = userIDInput.get()
    passwd = passwdInput.get()
    lock.acquire()
    print('ËØ∑Âä°ÂøÖÁ°ÆËÆ§ÊÇ®ÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÊ≠£Á°ÆÔºåËã•‰∏çÊ≠£Á°ÆÂèØËÉΩÊó†Ê≥ï‰∏ãËΩΩÂÖ®Êñá')
    print(f'ÊÇ®ÁöÑÁî®Êà∑Âêç‰∏∫{userID}')
    print(f'ÊÇ®ÁöÑÂØÜÁ†Å‰∏∫{passwd}')
    print('Á°ÆËÆ§Êó†ËØØÂêéÁÇπÂáªÊèê‰∫§ÊåâÈíÆ')
    global btnActive
    btnActive = True
    submitButton.config(state="normal")  # ÂêØÁî®ÊåâÈíÆ
    submitEvent.clear()  # Ê∏ÖÈô§‰πãÂâçÁöÑ‰∫ã‰ª∂ÔºåÁ°Æ‰øùÂèØ‰ª•ÈáçÊñ∞Á≠âÂæÖ
    submitEvent.wait()  # ÈòªÂ°ûÔºåÁõ¥Âà∞Áî®Êà∑ÁÇπÂáªÊèê‰∫§ÊåâÈíÆ
    btnActive = False  # Á¶ÅÁî®ÊåâÈíÆ
    submitButton.config(state="disabled")  # Á¶ÅÁî®ÊåâÈíÆ
    lock.release()

def main():
    url=urlInput.get()
    filepath=filepathInput.get()
    if filepath=='':
        filepath='./'
    if not filepath.endswith('/'):
        filepath+='/'
    global withhead
    my_withhead=withhead  #Â§çÂà∂‰∏Ä‰ªΩÈò≤Ê≠¢Á∫øÁ®ãÈó¥ÂÜ≤Á™Å
    print('‰∏ãËΩΩÁ®ãÂ∫èÂºÄÂßã')
    if url.find('max.book118') > 0:
        yuan = yuanchuangli.yuanchuangli(url, filepath,my_withhead)
        yuan.main()
    elif url.find('wenku.baidu') > 0:
        checkPasswd('ÁôæÂ∫¶ÊñáÂ∫ì')
        userID=userIDInput.get()
        passwd=passwdInput.get()
        wenKu = wenku.baiduWenku(url, filepath, userID, passwd, iscreatePopup, okEvent, inputQueue, my_withhead)
        wenKu.main()
    elif url.find('doc88') > 0:
        Doc88 = doc88.Doc88(url, filepath,my_withhead)
        Doc88.main()
    elif url.find('www.docin') > 0:
        checkPasswd('Ë±Ü‰∏ÅÁΩë')
        userID=userIDInput.get()
        passwd=passwdInput.get()
        Docin = docin.Docin(url, filepath, userID, passwd,my_withhead)
        Docin.main()
    elif url.find('renrendoc') > 0:
        renren = renrendoc.renrendoc(url, filepath,my_withhead)
        renren.main()
    elif url.find('jinchutou.com') > 0:
        gh = goldenhoe.goldenhoe(url, filepath,my_withhead)
        gh.main()
    else:
        print('Êú™ËØÜÂà´Âá∫ÊñáÊ°£ÂØπÂ∫îÁöÑÁΩëÁ´ô(Ê¨¢ËøéÂëäÁü•Âàõ‰ΩúËÄÖ‰ª•Ë°•ÂÖÖüòÉ')
        exit(0)

    print('‰øùÂ≠òÊàêÂäüÔºÅ')


def  inputChange(event):
    """ÂÆûÊó∂Ê£ÄÊµãËæìÂÖ•Ê°ÜÂÜÖÂÆπÁöÑÂèòÂåñ"""
    if not btnActive:
        return
    global lastInputTime
    currentTime = datetime.now()
    elapsedTime = currentTime - lastInputTime  # ËÆ°ÁÆóËøêË°åÊó∂Èïø
    lastInputTime = currentTime
    detectDelay=1     #1sÂª∂Ëøü
    # Â¶ÇÊûúÊúÄÂêé‰∏ÄÊ¨°ËæìÂÖ•Êó∂Èó¥Ë∑ùÁ¶ªÂΩìÂâçÊó∂Èó¥Ë∂ÖËøáËÆæÂÆöÁöÑÂª∂ËøüÊó∂Èó¥ÔºåÂàôÂ§ÑÁêÜËæìÂÖ•
    if elapsedTime.seconds> detectDelay:
        userID = userIDInput.get()
        passwd = passwdInput.get()
        print(f'ÊÇ®ÁöÑÁî®Êà∑ÂêçÊõ¥Êîπ‰∏∫{userID}')
        print(f'ÊÇ®ÁöÑÂØÜÁ†ÅÊõ¥Êîπ‰∏∫{passwd}')

def clearOutput():
    # Ê∏ÖÁ©∫ËæìÂá∫Ê°Ü
    outputBox.delete("1.0", tk.END)


def start():
    """
    ËøêË°å‰∏ãËΩΩÁ®ãÂ∫èÔºåÊâÄÊúâ‰∏ãËΩΩÁ®ãÂ∫èÂøÖÈ°ªÂú®‰∏ªÁ∫øÁ®ãÊ≠ª‰∫°ÁöÑÊó∂ÂÄôÊ≠ª‰∫°
    :return:
    """
    # ËÆæÁΩÆÊâÄÊúâËøõÁ®ã‰∏∫ÂÆàÊä§ËøõÁ®ã
    thread = threading.Thread(target=main,daemon=True)
    thread.start()

iconData=b"""AAABAAEAICAAAAEAIACoEAAAFgAAACgAAAAgAAAAQAAAAAEAIAAAAAAAABAAABAnAAAQJwAAAAAA
AAAAAAD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA
+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5
ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFKPnKxXv5ysWb+crFnPnKxZz5ysWc+crFnPnK
xZz5ysWc+crFnPnKxZz5ysWc+crFnPnKxZz5ysWc+crFnPnKxZz5ysWc+crFnPnKxZz5ysWc+crF
nPnKxZz5ysWc+crFnPnKxZv5ysV8+crFKPnKxQD5ysUA+crFAPnKxSv5ysXR+crF//nKxfH5ysXu
+crF7vnKxe75ysXu+crF7vnKxe75ysXu+crF7vnKxe75ysXu+crF7vnKxe75ysXu+crF7vnKxe75
ysXu+crF7vnKxe75ysXu+crF7vnKxe75ysXu+crF8fnKxf/5ysXR+crFK/nKxQD5ysUA+crFevnK
xf/5ysWd+crFLfnKxSv5ysUs/8/JKv/TzSn6y8Yr+crFLPnKxSz5ysUs+crFLPrLxSv/0MMq/9DD
KvrLxSv5ysUs+crFLPnKxSz5ysUs+svGK//TzSn/z8kq+crFLPnKxSv5ysUt+crFnfnKxf/5ysV6
+crFAPnKxQD5ysWL+crF//nKxWX5ysUA+crFANevqwAjISUSMSwvJP///wDqvroA+8zFANeqzgCG
XeQA//+rAAAA/xAAAP8Q//+qAIVd5ADXqs4A+8zFAOq+ugD///8AMSwvJCMhJRLXr6sA+crFAPnK
xQD5ysVl+crF//nKxYv5ysUA+crFAPnKxYv5ysX/+crFZvnKxQA/NzoAPzc6AT83OpA/NzrjPzc6
Qz84NwAjAP8AIwD/BiMA/zojAP+SIwD/0iMA/9IjAP+TIwD/OiMA/wYjAP8APzg3AD83OkM/Nzrj
Pzc6kEE5PAHnvLgA+crFAPnKxWT5ysX/+crFi/nKxQD5ysUA+crFi/nKxf/5ysVm+crFAD42OQA/
NzoAPzc6aj83Ov8/Nzq3Qz8eDCIA/x0jAP+gIwD/7yMA//wjAP/PIwD/zyMA//wjAP/vIwD/oCIA
/x1DPx4MPzc6tz83Ov8/NzpqnIB/APnKxRb5ysVO+crFqPnKxf/5ysWM+crFAPnKxQD5ysWL+crF
//nKxWb5ysUAT0RGAD83OgA/NzoSPzc6vz83Ov0+Nj5jIwD/kiMA//8jAP//IwD/6CMA/10jAP9d
IwD/6CMA//8jAP//IwD/kj42PmM/Nzr9Pzc6wCglKRD9zcg2+crFxfnKxfz5ysX9+crF//nKxYD5
ysUA+crFAPnKxYv5ysX/+crFZvnKxQD5y8UAPzc6AD83OgA/NzpPPzc59z00RekoCd7vIwD/9SMA
/8AjAP/yIwD/8SMA//EjAP/yIwD/wCMA//UoCd7vPTRF6T83Ofc8NDhO/+fhEfnKxcT5ysX9+crF
mvnKxVT5ysVe+crFIfnKxQD5ysUA+crFi/nKxf/5ysVm+crFAPnLxQA/NzoAPzc6AD83Ogg/NzmR
PTNH4CgL2fojAP/qIwD/NCMA/1gjAP/wIwD/8CMA/1gjAP80IwD/6igL2fo9M0fgPzc5kQAAAAT7
y8ZB+crF+vnKxb75ysUM+crFAPnKxQD5ysUA+crFAPnKxQD5ysWL+crF//nKxWb5ysUA+cvFAD43
OgA/NzoAPzc6AERAGQU0IYkjJAH6ziMA/+4jAP8qIwD/FiMA/90jAP/dIwD/FiMA/yojAP/uJAH6
zjQhiSNEQBkF16+rAPnKxUD5ysX5+crFwfnKxQ/5ysUA+crFAPnKxQD5ysUA+crFAPnKxYv5ysX/
+crFZvnKxQD5y8UAPzc6AD83OgA/NzoAQDg1JzsvWF8lBe7cIwD/7SMA/yojAP8YIwD/3iMA/94j
AP8YIwD/KiMA/+0lBe7cOy9YX0A4NSefg4IA+crFEvnKxb75ysX/+crFpfnKxWD5ysVq+crFJvnK
xQD5ysUA+crFi/nKxf/5ysVm+crFAPnLxQA/NzoAPzc6AD83Ohg/NznEPjRE/ykM0/8jAP/vIwD/
NSMA/xgjAP/dIwD/3SMA/xgjAP81IwD/7ykM0/8+NET/Pzc5xD83Ohikh4YA+crFMfnKxbz5ysX5
+crF//nKxf/5ysWD+crFAPnKxQD5ysWL+crF//nKxWb5ysUA8sXAAD83OgA/NzoAPzc6dj83Ov8/
Njy7JwngryMA//8jAP/EIwD/oyMA//MjAP/zIwD/oyMA/8QjAP//Jwngrz82PLs/Nzr/Pzc6dj83
OgDxxL8A+crFEfnKxUP5ysWh+crF//nKxYv5ysUA+crFAPnKxYv5ysX/+crFZvnKxQBKQEIAPzc6
AD83Oik/NzrePzc67UA5NDkfAP8ZIwH8oiUF7/slBPH/IwH97yMB/e8lBPH/JQXv+yMB/KIfAP8Z
QDk0OT83Ou0/NzrePzc6KT02OQD6y8UA+crFAPnKxWT5ysX/+crFi/nKxQD5ysUA+crFi/nKxf/5
ysVk+crFAM2npAA2MDQAPzc6jD83Ov8/NzqQPjVAAjAZpAA4KWwYOi5a1zosYOwtE7lHLRO5Rzos
YOw6LlrXOClsGDAZpAA+NUACPzc6kD83Ov8/NzqMPzc6AD83OgD5ysUA+crFZvnKxf/5ysWL+crF
APnKxQD5ysWL+crF//nKxYr5ysUi/c7IBP/UzwA/NzppPzc6pz83OiI/NzoAQDg1AEA5Mgs/ODi/
Pzg4+EA4NXFAODVxPzg4+D84OL9AOTILQDg1AD83OgA/NzoiPzc6pz83Omk/NzoAPjc6APnKxQD5
ysVm+crF//nKxYv5ysUA+crFAPnKxYn5ysX/+crF/PnKxeb5ysWX+8vGHP///wBAODsFPzc6AD83
OgA/NzoAPzc6AD83OmQ/Nzr8Pzc6/z83Ov8/Nzr8Pzc6ZD83OgA/NzoAPzc6AD83OgA/NzoFPzc6
AT83OgBJP0IA+crFAPnKxWb5ysX/+crFi/nKxQD5ysUA+crFO/nKxZX5ysWL+crFyPnKxf/5ysWm
/MzHCsCdmgA/NzoAPzc6AD83OgA/NzoBPzc6gz83Ov8/Nzq9Pzc6vT83Ov8/NzqDPzc6AT83OgA/
NzoAPzc6AD83OgA/NzoAPzc6APnLxQD5ysUA+crFZvnKxf/5ysWL+crFAPnKxQD5ysUA+crFAPnK
xQD5ysUf+crFzvnKxfT5ysU5+crFAPnKxQAAAAAAPzc6AD83Ogs/Nzq4Pzc63D83Oi4/NzouPzc6
3D83Org/NzoLPzc6AAAAAAAAAAAAAAAAAAAAAAAAAAAA+cvFAPnKxQD5ysVm+crF//nKxYv5ysUA
+crFAPnKxQD5ysUA+crFAPnKxQT5ysW1+crF/PnKxUb5ysUA+crFAAAAAAA/NzoAYEUwADg0PCQx
MT4n/5UAAP+VAAAxMT4nODQ8JGBFMAA/NzoAAAAAAAAAAAAAAAAAAAAAAAAAAAD5y8UA+crFAPnK
xWb5ysX/+crFi/nKxQD5ysUA+crFEfnKxTj5ysUv+crFdfnKxfT5ysXW+crFHvnKxQDxz7gAAAAA
AD83OgD9iAEA/5AAG/+LAHr/iQBM/4kATP+LAHr/kAAb/YgBAD83OgD6ysUA+crFAPnKxQD5ysUA
+crFAPnKxQD5ysUA+crFZvnKxf/5ysWL+crFAPnKxQD5ysV0+crF8/nKxfD5ysX/+crF4fnKxVP5
ysUA+crFAP+JAAD/iQAA/4kAAP+JAAD/iQBC/4kA8f+JAPr/iQD6/4kA8f+JAEL/iQAA/4kAAP9q
AAD5y8gA+crFAPnKxQD5ysUA+crFAPnKxQD5ysVk+crF//nKxYv5ysUA+crFAPnKxYz5ysX/+crF
w/nKxXn5ysUu+crFAPnKxQD5ysUA/4kAAP+JAAL/iQAk/4kAGv+JAAP/iQBJ/4kAkv+JAJL/iQBK
/4kAA/+JABr/iQAk/2gAAfnLyAn5ysVM+crFYvnKxWH5ysVh+crFXvnKxaD5ysX/+crFjPnKxQD5
ysUA+crFi/nKxf/5ysVm+crFAPnKxQD5ysUA+crFAPnJxQD/iQAA/4kAHP+JAM7/iQDP/4kAVf+J
AA//iQAB/4kAAf+JAA//iQBV/4kAz/+JAM7/gAAY+czLN/nKxe75ysX/+crF/vnKxfz5ysX9+crF
//nKxf/5ysV++crFAPnKxQD5ysWL+crF//nKxWb5ysUA+crFAPnKxQAAAAAAAAAAAP+JAAD/iQAJ
/4kAg/+JAPL/iQD7/4kAz/+JAKv/iQCr/4kAz/+JAPv/iQDy/4kAg/9cAAX5y8dC+crF+fnKxc75
ysVd+crFifnKxfL5ysX/+crFsPnKxR/5ysUA+crFAPnKxYv5ysX/+crFZvnKxQD5y8UAAAAAAAAA
AAAAAAAA/4kAAP+JAAD/iQAD/4kAQf+JAJr/iQDS/4kA6P+JAOj/iQDT/4kAm/+JAEH/iQAD+r2e
APnKxUL5ysX6+crFsPnKxTv5ysXL+crF/fnKxZ75ysUW+crFAPnKxQD5ysUA+crFi/nKxf/5ysVl
+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crGAPrEsgD8rGkA9u//AP96ABD/ggAg/4IAIP96ABD1
8f8A/KxpAPrEsgD5ysYA+crFP/nKxff5ysXg+crF4PnKxfz5ysWK+crFDfnKxQD5ysUA+crFAPnK
xQD5ysV1+crF//nKxan5ysU/+crFPfnKxT35ysU9+crFPfnKxT35ysU9+crFPfnKxT35ysY9+cvJ
PPnNzTv5zc07+cvJPPnKxj35ysU9+crFPfnKxTr5ysVv+crF+PnKxf/5ysX0+crFdvnKxQf5ysUA
+crFAPnKxQAAAAAA+crFAPnKxSP5ysXD+crF//nKxfn5ysX3+crF+PnKxfj5ysX4+crF+PnKxfj5
ysX4+crF+PnKxfj5ysX4+crF+PnKxfj5ysX4+crF+PnKxfj5ysX4+crF9/nKxfr5ysX/+crF6vnK
xWL5ysUC+crFAPnKxQD5ysUAAAAAAAAAAAD5ysUA+crFAPnKxRz5ysVm+crFhPnKxYX5ysWF+crF
hfnKxYX5ysWF+crFhfnKxYX5ysWF+crFhfnKxYX5ysWF+crFhfnKxYX5ysWF+crFhfnKxYX5ysWF
+crFhfnKxYP5ysVF+MrIAPnKxQD5ysUA+MnFAAAAAAAAAAAAAAAAAPnKxQD5ysUA+crFAPnKxQD5
ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnK
xQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxQD5ysUA+crFAPnKxAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA
AAAAAAAAAAAAAAAAAAAAAAAgB8AAIAfAACAAAAAAAAAAAAAAAAAAAAGAAAADgAAAAAAAAAAAAAEA
AAADAAAABwAAAA8=
"""

# ÂàõÂª∫‰∏ªÁ™óÂè£
root = tk.Tk()
root.title("ÊñáÊ°£‰∏ãËΩΩÂ∞èÂ∏ÆÊâã")  # Á™óÂè£Ê†áÈ¢ò
iconImage = Image.open(BytesIO(base64.b64decode(iconData)))
iconPhoto = ImageTk.PhotoImage(iconImage)
root.iconphoto(True, iconPhoto)

root.geometry("950x600")  # Á™óÂè£Â§ßÂ∞èÔºàÂÆΩxÈ´òÔºâ
# ÈÖçÁΩÆ grid Ë°åÂàóÁöÑÊùÉÈáçÔºå‰ΩøÂæóÂΩìÁ™óÂè£Â§ßÂ∞èÂèòÂåñÊó∂ÔºåÊéß‰ª∂ÂèØ‰ª•ÂìçÂ∫î
root.grid_columnconfigure(0, weight=1)  # ËÆæÁΩÆÁ¨¨0ÂàóÁöÑÊùÉÈáç
root.grid_columnconfigure(1, weight=10)  # ËÆæÁΩÆÁ¨¨1ÂàóÁöÑÊùÉÈáç
root.grid_rowconfigure(0, weight=1)  # ËÆæÁΩÆÁ¨¨0Ë°åÁöÑÊùÉÈáç
root.grid_rowconfigure(1, weight=1)  # ËÆæÁΩÆÁ¨¨1Ë°åÁöÑÊùÉÈáç
root.grid_rowconfigure(2, weight=1)  # ËÆæÁΩÆÁ¨¨2Ë°åÁöÑÊùÉÈáç
root.grid_rowconfigure(3, weight=1)  # ËÆæÁΩÆÁ¨¨3Ë°åÁöÑÊùÉÈáç
root.grid_rowconfigure(4, weight=1)  # ËÆæÁΩÆÁ¨¨4Ë°åÁöÑÊùÉÈáç
root.grid_rowconfigure(5, weight=5)  # ËÆæÁΩÆÁ¨¨5Ë°åÁöÑÊùÉÈáç
root.grid_rowconfigure(6, weight=1)  # ËÆæÁΩÆÁ¨¨6Ë°åÁöÑÊùÉÈáç
width=95
pady=5
withhead=False
tk.Label(root, text="‰Ω†ÁöÑurl:").grid(row=0, column=0, padx=10, pady=pady, sticky="e")  # Èù†Âè≥ÂØπÈΩê
urlInput = tk.Entry(root, width=width)
urlInput.grid(row=0, column=1, padx=10, pady=pady,sticky='ew')

# Á¨¨‰∫åË°å: Â∑¶‰æßÊòØÊ†áÁ≠æÔºåÂè≥‰æßÊòØËæìÂÖ•Ê°Ü
tk.Label(root, text="‰Ω†ÊÉ≥Â≠òÂÖ•ÁöÑ‰ΩçÁΩÆ:").grid(row=1, column=0, padx=10, pady=pady, sticky="e")
filepathInput = tk.Entry(root, width=width)
filepathInput.grid(row=1, column=1, padx=10, pady=pady,sticky='ew')

tk.Label(root, text="Áî®Êà∑ÂêçÔºàÁà¨ÂèñË±Ü‰∏ÅÁΩëÊàñÁôæÂ∫¶ÊñáÂ∫ìÊó∂ÈúÄË¶ÅÔºâ:").grid(row=2, column=0, padx=10, pady=pady, sticky="e")
userIDInput = tk.Entry(root, width=width)
userIDInput.grid(row=2, column=1, padx=10, pady=pady,sticky='ew')
userIDInput.bind("<KeyRelease>", inputChange)

tk.Label(root, text="ÂØÜÁ†ÅÔºàÁà¨ÂèñË±Ü‰∏ÅÁΩëÊàñÁôæÂ∫¶ÊñáÂ∫ìÊó∂ÈúÄË¶ÅÔºâ:").grid(row=3, column=0, padx=10, pady=pady, sticky="e")
passwdInput = tk.Entry(root, width=width,show='*')
passwdInput.grid(row=3, column=1, padx=10, pady=pady,sticky='ew')
passwdInput.bind("<KeyRelease>", inputChange)

tk.Label(root, text="ÊòØÂê¶ÊúâÂ§¥ÔºàÊòæÁ§∫Áà¨ÂèñËøáÁ®ãÔºâ:").grid(row=4, column=0, padx=10, pady=pady, sticky="e")
# ÂÆö‰πâÂèòÈáèÔºåÁî®‰∫éÁªëÂÆöÂçïÈÄâÊ°ÜÁöÑÂÄº
selectedOption = tk.StringVar(value="Âê¶")  # ËÆæÁΩÆÈªòËÆ§ÂÄº

# ÂàõÂª∫ "ÊòØ" ÂçïÈÄâÊ°Ü
yesButton = tk.Radiobutton(root, text="ÊòØ", variable=selectedOption, value="ÊòØ", command=onYesSelect)
yesButton.grid(row=4, column=1, padx=10, pady=pady, sticky="w")

# ÂàõÂª∫ "Âê¶" ÂçïÈÄâÊ°Ü
noButton = tk.Radiobutton(root, text="Âê¶", variable=selectedOption, value="Âê¶", command=onNoSelect)
noButton.grid(row=4, column=1, padx=50, pady=pady, sticky="w")

# ÂàõÂª∫ËæìÂá∫Ê°Ü
outputBox = tk.Text(root, height=25, width=width, bg="lightgrey", state="normal")
outputBox.grid(row=5, column=1, padx=10, pady=pady, sticky="news")
tips="""
Ê∏©È¶®ÊèêÁ§∫Ôºö

1.ËØ•ËΩØ‰ª∂ÊöÇÊó∂‰∏çÊîØÊåÅÊâπÈáè‰∏ãËΩΩÔºå
‰ΩÜÊòØÂèØ‰ª•ÂêåÊó∂‰∏ãËΩΩÂ§ö‰∏™ÊñáÊ°£Ôºõ

2.‰∏ãËΩΩÂ§ö‰∏™ÊñáÊ°£Êó∂ËæìÂá∫
‰ºöÊØîËæÉ‰π±Ôºå‰∏∫Ê≠£Â∏∏Áé∞Ë±°Ôºõ

3.Âº∫ÁÉàÂª∫ËÆÆÂú®ÁΩëÁªúËâØÂ•ΩÁöÑÊÉÖÂÜµ‰∏ã
ËøõË°å‰∏ãËΩΩÔºå‰ª•ÂÖçÂ§±Ë¥•Ôºõ

4.Êú¨ËΩØ‰ª∂‰ªÖ‰æõÁà¨Ëô´‰∫§ÊµÅÂ≠¶‰π†‰ΩøÁî®
ÔºåËØ∑ÂãøÂïÜÁî®Ôºõ

5.Êú¨ËΩØ‰ª∂ÊîØÊåÅ‰∏ãËΩΩÁôæÂ∫¶ÊñáÂ∫ìÔºå
ÈÅìÂÆ¢Â∑¥Â∑¥ÔºåË±Ü‰∏ÅÔºåÂéüÂàõÂäõÔºå
‰∫∫‰∫∫ÊñáÂ∫ìÔºåÈáëÈîÑÂ§¥ÊñáÂ∫ì„ÄÇ

made by saydontgo
"""
tk.Label(root, text=tips).grid(row=5, column=0, padx=10, pady=pady, sticky="n")

# Ê∏ÖÁ©∫ËæìÂá∫ÊåâÈíÆ
clearButton = tk.Button(root, text="Ê∏ÖÁ©∫ËæìÂá∫", command=clearOutput)
clearButton.grid(row=6, column=1, padx=10, pady=pady, sticky="e")

# ÂºÄÂßãÊâßË°åËÑöÊú¨ÊåâÈíÆ
startButton = tk.Button(root, text="‰∏ÄÈîÆÂºÄÂßã‰∏ãËΩΩ", command=start)
startButton.grid(row=4, column=1, padx=10, pady=pady, sticky="e")

# Êèê‰∫§ÊåâÈíÆ
submitButton = tk.Button(root, text="Êèê‰∫§", command=onSubmit)
submitButton.grid(row=4, column=1, padx=110, pady=pady, sticky="e")
submitButton.config(state="disabled")  # Á¶ÅÁî®ÊåâÈíÆ
# ÈáçÂÆöÂêë sys.stdout Âà∞ËæìÂá∫Ê°Ü
sys.stdout = RedirectOutput(outputBox)

lock=threading.Lock()
lastInputTime=datetime.now()
taskQueue=Queue()

checkEvent()

# ËøêË°å‰∏ªÂæ™ÁéØ
root.mainloop()
